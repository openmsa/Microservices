<ObjectDefinition>
  <information>
    <icon>/images/repository/CommandDefinition/icons/webfilter_fortinet.png</icon>
    <description>Web Filter</description>
    <displayField>object_id</displayField>
    <serviceTaskType/>
    <order>13020</order>
    <visibility>4</visibility>
    <configType>cli</configType>
    <createTemplateId/>
    <createTemplateObject/>
    <defaultDisplay>false</defaultDisplay>
    <dynamic>false</dynamic>
    <importIfMandatoryPresent>false</importIfMandatoryPresent>
    <maxInstances>0</maxInstances>
    <relatedObjects/>
    <name>Web Filter</name>
    <group>Security Profile|Web Filter</group>
    <importonce>false</importonce>
    <importrank>2</importrank>
    <reorderinstances>false</reorderinstances>
    <sortascending>true</sortascending>
    <sortauto>true</sortauto>
    <sortnumerical>true</sortnumerical>
    <sortvariable>params._order</sortvariable>
  </information>
  <variables frozen="0">
    <variable displayName="Profile Name" name="params.object_id" startIncrement="0" type="String" mandatoryArray="false" visible="true" description="" groupSeparator="" groupDisplayName="" displayOrder="0" increment="0" refServiceURI="" keepOnImport="false" editable="true" onlyDetailView="false" localVarNameMatch="" remoteVarNameMatch="" arrayCanAdd="true" arrayCanRemove="true" arrayCanMove="true" arrayCanEdit="true" isMandatory="true" isUserLocked="false" isGrouped="false" isSearchable="false" isUniqueGlobal="false"/>
    <variable displayName="Blocked Categories" name="params.categories_0_id" startIncrement="0" type="Index" mandatoryArray="false" visible="true" description="" groupSeparator="" groupDisplayName="" displayOrder="1" increment="0" refServiceURI="" keepOnImport="false" editable="false" onlyDetailView="false" localVarNameMatch="" remoteVarNameMatch="" arrayCanAdd="true" arrayCanRemove="true" arrayCanMove="true" arrayCanEdit="true" isMandatory="false" isUserLocked="false" isGrouped="false" isSearchable="false" isUniqueGlobal="false">
      <values>
        <value displayValue="Abortion">7</value>
        <value displayValue="Advertising">17</value>
        <value displayValue="Advocacy Organizations">9</value>
        <value displayValue="Alcohol">64</value>
        <value displayValue="Alternative Beliefs">2</value>
        <value displayValue="Armed Forces">53</value>
        <value displayValue="Arts and Culture">29</value>
        <value displayValue="Brokerage and Trading">18</value>
        <value displayValue="Business">49</value>
        <value displayValue="Child Abuse">83</value>
        <value displayValue="Child Education">77</value>
        <value displayValue="Content Servers">82</value>
        <value displayValue="Dating">15</value>
        <value displayValue="Digital Postcards">71</value>
        <value displayValue="Discrimination">5</value>
        <value displayValue="Domain Parking">85</value>
        <value displayValue="Drug Abuse">1</value>
        <value displayValue="Dynamic Content">54</value>
        <value displayValue="Education">30</value>
        <value displayValue="Entertainment">28</value>
        <value displayValue="Explicit Violence">6</value>
        <value displayValue="Extremist Groups">12</value>
        <value displayValue="File Sharing and Storage">24</value>
        <value displayValue="Finance and Banking">31</value>
        <value displayValue="Folklore">58</value>
        <value displayValue="Freeware Downloads">19</value>
        <value displayValue="Gambling">11</value>
        <value displayValue="Games">20</value>
        <value displayValue="General Organizations">43</value>
        <value displayValue="Global Religion">40</value>
        <value displayValue="Government and Legal Organisation">51</value>
        <value displayValue="Hacking">3</value>
        <value displayValue="Health and Wellness">33</value>
        <value displayValue="Illegal or Unethical">4</value>
        <value displayValue="Information and Computer Security">50</value>
        <value displayValue="Information Technology">52</value>
        <value displayValue="Instant Messaging">69</value>
        <value displayValue="Internet Radio and TV">75</value>
        <value displayValue="Internet Telephony">76</value>
        <value displayValue="Job Search">34</value>
        <value displayValue="Lingerie and Swimsuit">66</value>
        <value displayValue="Malicious Websites">26</value>
        <value displayValue="Marijuana">57</value>
        <value displayValue="Meaningless Content">55</value>
        <value displayValue="Medicine">35</value>
        <value displayValue="News and Media">36</value>
        <value displayValue="Newsgroups and Message Boards">70</value>
        <value displayValue="Nudity and Risque">13</value>
        <value displayValue="Other Adult Materials">8</value>
        <value displayValue="Peer-to-peer File Sharing">72</value>
        <value displayValue="Personal Privacy">87</value>
        <value displayValue="Personal Vehicles">48</value>
        <value displayValue="Personal Websites and Blogs">80</value>
        <value displayValue="Phishing">61</value>
        <value displayValue="Plagiarism">62</value>
        <value displayValue="Political Organizations">38</value>
        <value displayValue="Pornography">14</value>
        <value displayValue="Proxy Avoidance">59</value>
        <value displayValue="Real Estate">78</value>
        <value displayValue="Reference">39</value>
        <value displayValue="Restaurant and Dining">79</value>
        <value displayValue="Search Engines and Portals">41</value>
        <value displayValue="Secure Websites">81</value>
        <value displayValue="Sex Education">63</value>
        <value displayValue="Shopping and Auction">42</value>
        <value displayValue="Social Networking">37</value>
        <value displayValue="Society and Lifestyles">44</value>
        <value displayValue="Spam URLs">86</value>
        <value displayValue="Sports">46</value>
        <value displayValue="Sports Hunting and War Games">67</value>
        <value displayValue="Streaming Media and Download">25</value>
        <value displayValue="Tobacco">65</value>
        <value displayValue="Travel">47</value>
        <value displayValue="Unrated">0</value>
        <value displayValue="Weapons (sales)">16</value>
        <value displayValue="Web-based Applications">84</value>
        <value displayValue="Web-based Email">23</value>
        <value displayValue="Web Chat">68</value>
        <value displayValue="Web Hosting">56</value>
      </values>
    </variable>
    <variable displayName="URL Filter" name="params.url_filter_status" startIncrement="0" type="Boolean" mandatoryArray="false" visible="true" description="" groupSeparator="" groupDisplayName="" displayOrder="2" increment="0" refServiceURI="" keepOnImport="false" editable="true" onlyDetailView="true" localVarNameMatch="" remoteVarNameMatch="" arrayCanAdd="true" arrayCanRemove="true" arrayCanMove="true" arrayCanEdit="true" default="false" isMandatory="false" isUserLocked="false" isGrouped="false" isSearchable="false" isUniqueGlobal="false"/>
    <variable displayName="URL Filter ID" name="params.filter_id" startIncrement="0" type="AutoIncrement" mandatoryArray="false" visible="false" description="" groupSeparator="" groupDisplayName="" displayOrder="3" increment="0" refServiceURI="" keepOnImport="false" editable="true" onlyDetailView="true" localVarNameMatch="" remoteVarNameMatch="" arrayCanAdd="true" arrayCanRemove="true" arrayCanMove="true" arrayCanEdit="true" isMandatory="true" isUserLocked="true" isGrouped="false" isSearchable="false" isUniqueGlobal="false"/>
    <variable displayName="ID" name="params.urlfilter_0_url_id" startIncrement="0" type="Composite" mandatoryArray="false" visible="true" description="" groupSeparator="" groupDisplayName="" displayOrder="5" increment="0" refServiceURI="" keepOnImport="false" editable="true" onlyDetailView="false" localVarNameMatch="" remoteVarNameMatch="" arrayCanAdd="true" arrayCanRemove="true" arrayCanMove="true" arrayCanEdit="true" selector="params.url_filter_status" isMandatory="false" isUserLocked="true" isGrouped="false" isSearchable="false" isUniqueGlobal="false">
      <behaviors>
        <behaviour displayName="url_id" displayOrder="0" maxLength="100" name="params.urlfilter.0.url_id" selectorValue="false" startIncrement="0" type="String"/>
        <behaviour displayName="ID" displayOrder="0" maxLength="200" name="params.urlfilter.0.url_id" selectorValue="true" startIncrement="0" type="AutoIncrement"/>
      </behaviors>
      <sections>
        <section>URL Filters</section>
      </sections>
    </variable>
    <variable displayName="URL" name="params.urlfilter_0_url" startIncrement="0" type="Composite" mandatoryArray="false" visible="false" description="" groupSeparator="" groupDisplayName="" displayOrder="6" increment="0" refServiceURI="" keepOnImport="false" editable="true" onlyDetailView="false" localVarNameMatch="" remoteVarNameMatch="" arrayCanAdd="true" arrayCanRemove="true" arrayCanMove="true" arrayCanEdit="true" selector="params.url_filter_status" isMandatory="false" isUserLocked="false" isGrouped="false" isSearchable="false" isUniqueGlobal="false">
      <behaviors>
        <behaviour displayName="url" displayOrder="0" maxLength="100" name="params.urlfilter.0.url" selectorValue="false" startIncrement="0" type="String"/>
        <behaviour displayName="URL" displayOrder="0" maxLength="200" name="params.urlfilter.0.url" selectorValue="true" startIncrement="0" type="String"/>
      </behaviors>
      <sections>
        <section>URL Filters</section>
      </sections>
    </variable>
    <variable displayName="Type" name="params.urlfilter_0_type" startIncrement="0" type="Composite" mandatoryArray="false" visible="false" description="" groupSeparator="" groupDisplayName="" displayOrder="7" increment="0" refServiceURI="" keepOnImport="false" editable="false" onlyDetailView="false" localVarNameMatch="" remoteVarNameMatch="" arrayCanAdd="true" arrayCanRemove="true" arrayCanMove="true" arrayCanEdit="true" selector="params.url_filter_status" isMandatory="false" isUserLocked="false" isGrouped="false" isSearchable="false" isUniqueGlobal="false">
      <values>
        <value displayValue="simple">simple</value>
        <value displayValue="wildcard">wildcard</value>
        <value displayValue="regex">regex</value>
      </values>
      <behaviors>
        <behaviour displayName="type" displayOrder="0" maxLength="100" name="params.urlfilter.0.type" selectorValue="false" startIncrement="0" type="String"/>
        <behaviour displayName="Type" displayOrder="0" maxLength="200" name="params.urlfilter.0.type" selectorValue="true" startIncrement="0" type="String"/>
      </behaviors>
      <sections>
        <section>URL Filters</section>
      </sections>
    </variable>
    <variable displayName="Action" name="params.urlfilter_0_action" startIncrement="0" type="Composite" mandatoryArray="false" visible="false" description="" groupSeparator="" groupDisplayName="" displayOrder="8" increment="0" refServiceURI="" keepOnImport="false" editable="false" onlyDetailView="false" localVarNameMatch="" remoteVarNameMatch="" arrayCanAdd="true" arrayCanRemove="true" arrayCanMove="true" arrayCanEdit="true" selector="params.url_filter_status" isMandatory="false" isUserLocked="false" isGrouped="false" isSearchable="false" isUniqueGlobal="false">
      <values>
        <value displayValue="exempt">exempt</value>
        <value displayValue="block">block</value>
      </values>
      <behaviors>
        <behaviour displayName="action" displayOrder="0" maxLength="100" name="params.urlfilter.0.action" selectorValue="false" startIncrement="0" type="String"/>
        <behaviour displayName="Action" displayOrder="0" maxLength="200" name="params.urlfilter.0.action" selectorValue="true" startIncrement="0" type="String"/>
      </behaviors>
      <sections>
        <section>URL Filters</section>
      </sections>
    </variable>
    <variable displayName="Comments" name="params.comment" startIncrement="0" type="String" mandatoryArray="false" visible="true" description="" groupSeparator="" groupDisplayName="" displayOrder="9" increment="0" refServiceURI="" keepOnImport="false" editable="true" onlyDetailView="false" localVarNameMatch="" remoteVarNameMatch="" arrayCanAdd="true" arrayCanRemove="true" arrayCanMove="true" arrayCanEdit="true" isMandatory="false" isUserLocked="false" isGrouped="false" isSearchable="false" isUniqueGlobal="false"/>
    <variable displayName="Rating" name="params.rating" startIncrement="0" type="Link" mandatoryArray="false" visible="true" description="" groupSeparator="" groupDisplayName="" displayOrder="10" increment="0" refServiceURI="" keepOnImport="false" editable="true" onlyDetailView="true" localVarNameMatch="" remoteVarNameMatch="" arrayCanAdd="true" arrayCanRemove="true" arrayCanMove="true" arrayCanEdit="true" default="http://www.fortiguard.com/static/webfiltering.html" isMandatory="false" isUserLocked="true" isGrouped="false" isSearchable="false" isUniqueGlobal="false"/>
  </variables>
  <example>
    <content>config webfilter profileedit "default"set comment "Default web filtering."set post-action comfortconfig ftgd-wfconfig filtersedit 77set category 81nextedit 78set category 84nextedit 79nextendendset log-all-url enableset web-content-log disableset web-filter-activex-log disableset web-filter-command-block-log disableset web-filter-cookie-log disableset web-filter-applet-log disableset web-filter-jscript-log disableset web-filter-js-log disableset web-filter-vbs-log disableset web-filter-unknown-log disableset web-filter-referer-log disableset web-filter-cookie-removal-log disableset web-url-log disableset web-invalid-domain-log disableset web-ftgd-err-log disableset web-ftgd-quota-usage disable
end
</content>
  </example>
  <command name="IMPORT">
    <operation>show full-configuration webfilter profile</operation>
    <post_template>{assign_object_variable var="url_filter_status" value="false"}
{foreach $URL_Filter|sortby:_order as $filter}{if isset($params.filter_id) &amp;&amp; $params.filter_id == $filter.object_id}{assign_object_variable var="url_filter_status" value="true"}{assign_object_variable var="filter_id" value=$filter.object_id}{assign_object_variable var="filter_name" value=$filter.filter_name}{if !empty($filter.urls)}{foreach $filter.urls as$index => $url}{assign_object_variable var="urlfilter.{$index}.url_id" value=$url.url_id}{assign_object_variable var="urlfilter.{$index}.url" value=$url.url}{assign_object_variable var="urlfilter.{$index}.action" value=$url.action}{assign_object_variable var="urlfilter.{$index}.type" value=$url.type}{/foreach}{/if}{break}{/if}
{/foreach}
{if $params.object_id == "default"}
{assign_object_variable var="_readonly" value="true"}
{else}
{assign_object_variable var="_readonly" value="false"}
{/if}</post_template>
    <parser>
      <section>
        <regexp>@edit(?! "(default)") "(?&lt;object_id>[^"]+)"@</regexp>
      </section>
      <lines>
        <line>
          <array name="categories">
            <lines/>
            <regexp>@set category(?! 143) (?&lt;id>\d+)@</regexp>
            <mregexp>@^\s \s*$@</mregexp>
          </array>
          <regexp/>
        </line>
        <ignore>
          <regexp>@end@</regexp>
        </ignore>
        <ignore>
          <regexp>@set @</regexp>
        </ignore>
        <ignore>
          <regexp>@config @</regexp>
        </ignore>
        <ignore>
          <regexp>@unset @</regexp>
        </ignore>
        <ignore>
          <regexp>@edit \d@</regexp>
        </ignore>
        <ignore>
          <regexp>@next@</regexp>
        </ignore>
      </lines>
    </parser>
  </command>
  <command name="UPDATE">
    <operation>config webfilter urlfilteredit {$params.filter_id}set name "{$params.object_id}"config entriespurge{foreach $params.urlfilter as $filter}edit {$filter.url_id}set url "{$filter.url}"set type {$filter.type}set action {$filter.action}{if $filter.action == "exempt"}set exempt web-content activex-java-cookie dlp fortiguard range-block{/if}set status enablenext{/foreach}endnext
endconfig webfilter profileedit "{$params.object_id}"set comment "{$params.comment}"config overrideset ovrd-user-group ""endconfig web{if empty($params.filter_id)}unset urlfilter-table{else}set urlfilter-table {$params.filter_id}{/if}endconfig ftgd-wfset options error-allowset category-override 140 141 142 143config filterspurge{foreach $params.categories as $category}{if isset($category.id) &amp;&amp; $category.id !== ""}{if $category.id === "0"}edit 144{else}edit {$category.id}{/if}set category {$category.id}set action blockset log enablenext{/if}{/foreach}edit 143set category 143set action blockset log enablenextendendset log-all-url disablenext
end
</operation>
  </command>
  <command name="CONSTRAINT"/>
  <command name="CREATE">
    <operation>config webfilter urlfilteredit {$params.filter_id}set name "{$params.object_id}"config entries{foreach $params.urlfilter as $filter}edit {$filter.url_id}set url "{$filter.url}"set type {$filter.type}set action {$filter.action}{if $filter.action == "exempt"}set exempt web-content activex-java-cookie dlp fortiguard range-block{/if}set status enablenext{/foreach}endnext
endconfig webfilter profileedit "{$params.object_id}"set comment "{$params.comment}"config overrideset ovrd-user-group ""endconfig web{if empty($params.filter_id)}unset urlfilter-table{else}set urlfilter-table {$params.filter_id}{/if}endconfig ftgd-wfset options error-allowset category-override 140 141 142 143config filters{foreach $params.categories as $category}{if isset($category.id) &amp;&amp; $category.id !== ""}{if $category.id === "0"}edit 144{else}edit {$category.id}{/if}set category {$category.id}set action blockset log enablenext{/if}{/foreach}edit 143set category 143set action blockset log enablenextendendset log-all-url disablenext
end
</operation>
  </command>
  <command name="DELETE">
    <operation>{assign var="params" value=$Web_Filter.$object_id}
config webfilter profiledelete "{$params.object_id}"
end
config webfilter urlfilterdelete {$params.filter_id}
end
</operation>
  </command>
  <command name="READ"/>
  <command name="LIST"/>
</ObjectDefinition>
