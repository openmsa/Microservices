<ObjectDefinition>
  <information>
    <icon>/images/repository/CommandDefinition/icons/antivirus_fortinet.png</icon>
    <description>Antivirus</description>
    <displayField>object_id</displayField>
    <serviceTaskType/>
    <order>2000</order>
    <visibility>0</visibility>
    <configType>cli</configType>
    <createTemplateId/>
    <createTemplateObject/>
    <defaultDisplay>false</defaultDisplay>
    <dynamic>false</dynamic>
    <importIfMandatoryPresent>false</importIfMandatoryPresent>
    <maxInstances>0</maxInstances>
    <relatedObjects/>
    <name>Antivirus</name>
    <group>Security Profile|Antivirus</group>
    <importonce>false</importonce>
    <importrank>1</importrank>
    <reorderinstances>false</reorderinstances>
    <sortascending>true</sortascending>
    <sortauto>true</sortauto>
    <sortnumerical>true</sortnumerical>
    <sortvariable>params._order</sortvariable>
  </information>
  <variables frozen="0">
    <variable displayName="Profile Name" name="params.object_id" startIncrement="0" type="String" mandatoryArray="false" visible="true" description="" groupSeparator="" groupDisplayName="" displayOrder="0" increment="0" refServiceURI="" keepOnImport="false" editable="true" onlyDetailView="false" localVarNameMatch="" remoteVarNameMatch="" arrayCanAdd="true" arrayCanRemove="true" arrayCanMove="true" arrayCanEdit="true" isMandatory="false" isUserLocked="false" isGrouped="false" isSearchable="false" isUniqueGlobal="false"/>
    <variable displayName="Detect Botnet C&amp;C Server" name="params.scanbotnet" startIncrement="0" type="String" mandatoryArray="false" visible="true" description="" groupSeparator="" groupDisplayName="" displayOrder="1" increment="0" refServiceURI="" keepOnImport="false" editable="false" onlyDetailView="false" localVarNameMatch="" remoteVarNameMatch="" arrayCanAdd="true" arrayCanRemove="true" arrayCanMove="true" arrayCanEdit="true" default="disable" isMandatory="true" isUserLocked="false" isGrouped="false" isSearchable="false" isUniqueGlobal="false">
      <values>
        <value displayValue="Block">block</value>
        <value displayValue="Monitor">monitor</value>
        <value displayValue="Disable">disable</value>
      </values>
    </variable>
    <variable displayName="Protocol" name="params.protocols_0_protocol" startIncrement="0" type="String" mandatoryArray="false" visible="false" description="" groupSeparator="" groupDisplayName="" displayOrder="2" increment="0" refServiceURI="" keepOnImport="false" editable="false" onlyDetailView="false" localVarNameMatch="" remoteVarNameMatch="" arrayCanAdd="true" arrayCanRemove="true" arrayCanMove="true" arrayCanEdit="true" default="http" isMandatory="false" isUserLocked="false" isGrouped="false" isSearchable="false" isUniqueGlobal="false">
      <values>
        <value displayValue="http">http</value>
        <value displayValue="ftp">ftp</value>
        <value displayValue="imap">imap</value>
        <value displayValue="pop3">pop3</value>
        <value displayValue="smtp">smtp</value>
        <value displayValue="mapi">mapi</value>
        <value displayValue="nntp">nntp</value>
      </values>
      <sections>
        <section>Protocols</section>
      </sections>
    </variable>
    <variable displayName="Options" name="params.protocols_0_options" startIncrement="0" type="String" mandatoryArray="false" visible="false" description="" groupSeparator="" groupDisplayName="" displayOrder="3" increment="0" refServiceURI="" keepOnImport="false" editable="false" onlyDetailView="false" localVarNameMatch="" remoteVarNameMatch="" arrayCanAdd="true" arrayCanRemove="true" arrayCanMove="true" arrayCanEdit="true" default="unset " isMandatory="false" isUserLocked="false" isGrouped="false" isSearchable="false" isUniqueGlobal="false">
      <values>
        <value displayValue="Block">scan</value>
        <value displayValue="Monitor">avmonitor</value>
        <value displayValue="Disable">unset </value>
      </values>
      <sections>
        <section>Protocols</section>
      </sections>
    </variable>
    <variable displayName="HTTP" name="params.webhttp" startIncrement="0" type="String" mandatoryArray="false" visible="true" description="" groupSeparator="" groupDisplayName="" displayOrder="4" increment="0" refServiceURI="" keepOnImport="false" editable="false" onlyDetailView="false" localVarNameMatch="" remoteVarNameMatch="" arrayCanAdd="true" arrayCanRemove="true" arrayCanMove="true" arrayCanEdit="true" default="unset" isMandatory="true" isUserLocked="false" isGrouped="false" isSearchable="false" isUniqueGlobal="false">
      <values>
        <value displayValue="Block">scan</value>
        <value displayValue="Monitor">scan avmonitor</value>
        <value displayValue="Disable">unset</value>
      </values>
      <sections>
        <section>WEB</section>
      </sections>
    </variable>
    <variable displayName="FTP" name="params.filetransfert" startIncrement="0" type="String" mandatoryArray="false" visible="true" description="" groupSeparator="" groupDisplayName="" displayOrder="5" increment="0" refServiceURI="" keepOnImport="false" editable="false" onlyDetailView="false" localVarNameMatch="" remoteVarNameMatch="" arrayCanAdd="true" arrayCanRemove="true" arrayCanMove="true" arrayCanEdit="true" default="unset" isMandatory="true" isUserLocked="false" isGrouped="false" isSearchable="false" isUniqueGlobal="false">
      <values>
        <value displayValue="Block">scan</value>
        <value displayValue="Monitor">scan avmonitor</value>
        <value displayValue="Disable">unset</value>
      </values>
      <sections>
        <section>File Transfert</section>
      </sections>
    </variable>
    <variable displayName="SMTP" name="params.mailsmtp" startIncrement="0" type="String" mandatoryArray="false" visible="true" description="" groupSeparator="" groupDisplayName="" displayOrder="6" increment="0" refServiceURI="" keepOnImport="false" editable="false" onlyDetailView="false" localVarNameMatch="" remoteVarNameMatch="" arrayCanAdd="true" arrayCanRemove="true" arrayCanMove="true" arrayCanEdit="true" default="unset" isMandatory="true" isUserLocked="false" isGrouped="false" isSearchable="false" isUniqueGlobal="false">
      <values>
        <value displayValue="Block">scan</value>
        <value displayValue="Monitor">scan avmonitor</value>
        <value displayValue="Disable">unset</value>
      </values>
      <sections>
        <section>MAIL</section>
      </sections>
    </variable>
    <variable displayName="POP3" name="params.mailpop3" startIncrement="0" type="String" mandatoryArray="false" visible="true" description="" groupSeparator="" groupDisplayName="" displayOrder="7" increment="0" refServiceURI="" keepOnImport="false" editable="false" onlyDetailView="false" localVarNameMatch="" remoteVarNameMatch="" arrayCanAdd="true" arrayCanRemove="true" arrayCanMove="true" arrayCanEdit="true" default="unset" isMandatory="true" isUserLocked="false" isGrouped="false" isSearchable="false" isUniqueGlobal="false">
      <values>
        <value displayValue="Block">scan</value>
        <value displayValue="Monitor">scan avmonitor</value>
        <value displayValue="Disable">unset</value>
      </values>
      <sections>
        <section>MAIL</section>
      </sections>
    </variable>
    <variable displayName="IMAP" name="params.mailimap" startIncrement="0" type="String" mandatoryArray="false" visible="true" description="" groupSeparator="" groupDisplayName="" displayOrder="8" increment="0" refServiceURI="" keepOnImport="false" editable="false" onlyDetailView="false" localVarNameMatch="" remoteVarNameMatch="" arrayCanAdd="true" arrayCanRemove="true" arrayCanMove="true" arrayCanEdit="true" default="unset" isMandatory="true" isUserLocked="false" isGrouped="false" isSearchable="false" isUniqueGlobal="false">
      <values>
        <value displayValue="Block">scan</value>
        <value displayValue="Monitor">scan avmonitor</value>
        <value displayValue="Disable">unset</value>
      </values>
      <sections>
        <section>MAIL</section>
      </sections>
    </variable>
    <variable displayName="MAPI" name="params.mailmapi" startIncrement="0" type="String" mandatoryArray="false" visible="true" description="" groupSeparator="" groupDisplayName="" displayOrder="9" increment="0" refServiceURI="" keepOnImport="false" editable="false" onlyDetailView="false" localVarNameMatch="" remoteVarNameMatch="" arrayCanAdd="true" arrayCanRemove="true" arrayCanMove="true" arrayCanEdit="true" default="unset" isMandatory="true" isUserLocked="false" isGrouped="false" isSearchable="false" isUniqueGlobal="false">
      <values>
        <value displayValue="Block">scan</value>
        <value displayValue="Monitor">scan avmonitor</value>
        <value displayValue="Disable">unset</value>
      </values>
      <sections>
        <section>MAIL</section>
      </sections>
    </variable>
    <variable displayName="NNTP" name="params.newsnntp" startIncrement="0" type="String" mandatoryArray="false" visible="true" description="" groupSeparator="" groupDisplayName="" displayOrder="10" increment="0" refServiceURI="" keepOnImport="false" editable="false" onlyDetailView="false" localVarNameMatch="" remoteVarNameMatch="" arrayCanAdd="true" arrayCanRemove="true" arrayCanMove="true" arrayCanEdit="true" default="unset" isMandatory="true" isUserLocked="false" isGrouped="false" isSearchable="false" isUniqueGlobal="false">
      <values>
        <value displayValue="Block">scan</value>
        <value displayValue="Monitor">scan avmonitor</value>
        <value displayValue="Disable">unset</value>
      </values>
      <sections>
        <section>News</section>
      </sections>
    </variable>
    <variable displayName="Comments" name="params.comment" startIncrement="0" type="String" mandatoryArray="false" visible="true" description="" groupSeparator="" groupDisplayName="" displayOrder="11" increment="0" refServiceURI="" keepOnImport="false" editable="true" onlyDetailView="false" localVarNameMatch="" remoteVarNameMatch="" arrayCanAdd="true" arrayCanRemove="true" arrayCanMove="true" arrayCanEdit="true" isMandatory="false" isUserLocked="false" isGrouped="false" isSearchable="false" isUniqueGlobal="false"/>
  </variables>
  <example>
    <content>edit "didiAV"set comment ''set replacemsg-group ''set inspection-mode proxyset scan-botnet-connections monitorset ftgd-analytics disableconfig httpunset optionsunset archive-blockunset archive-logset emulator enableendconfig ftpunset optionsunset archive-blockunset archive-logset emulator enableendconfig imapunset optionsunset archive-blockunset archive-logset emulator enableendconfig pop3unset optionsunset archive-blockunset archive-logset emulator enableend
</content>
  </example>
  <command name="IMPORT">
    <operation>show full antivirus profile</operation>
    <post_template>{foreach $params.protocols as $index => $proto}{if $proto.protocol=="http"}
{assign_object_variable var="webhttp" value=$proto.options}{elseif $proto.protocol=="smtp"}
{assign_object_variable var="mailsmtp" value=$proto.options}{elseif $proto.protocol=="ftp"}
{assign_object_variable var="filetransfert" value=$proto.options}{elseif $proto.protocol=="pop3"}
{assign_object_variable var="mailpop3" value=$proto.options}{elseif $proto.protocol=="imap"}
{assign_object_variable var="mailimap" value=$proto.options}{elseif $proto.protocol=="mapi"}
{assign_object_variable var="mailmapi" value=$proto.options}{elseif $proto.protocol=="nntp"}
{assign_object_variable var="newsnntp" value=$proto.options}{/if}
{/foreach}</post_template>
    <parser>
      <section>
        <regexp>@edit(?! "default") "(?&lt;object_id>[^"]+)"@</regexp>
      </section>
      <lines>
        <line>
          <array/>
          <regexp>@set scan-botnet-connections (?&lt;scanbotnet>\S+)@</regexp>
        </line>
        <line>
          <array name="protocols">
            <lines/>
            <regexp>@config (?&lt;protocol>http|smtp|pop3|imap|ftp|nntp|mapi)@</regexp>
            <mregexp>@^\s \s*$@</mregexp>
          </array>
          <regexp/>
        </line>
        <ignore>
          <regexp>@end$@</regexp>
        </ignore>
      </lines>
    </parser>
  </command>
  <command name="UPDATE">
    <operation>config antivirus profileedit "{$params.object_id}"set comment "{$params.comment}"set inspection-mode proxyset scan-botnet-connections {$params.scanbotnet}config http{if $params.webhttp=="unset"}unset options{else}set options {$params.webhttp}{/if}endconfig ftp{if $params.filetransfert=="unset"}unset options{else}set options {$params.filetransfert}{/if}endconfig imap{if $params.mailimap=="unset"}unset options{else}set options {$params.mailimap}{/if}endconfig pop3{if $params.mailpop3=="unset"}unset options{else}set options {$params.mailpop3}{/if}endconfig smtp{if $params.mailsmtp=="unset"}unset options{else}set options {$params.mailsmtp}{/if}endconfig mapi{if $params.mailmapi=="unset"}unset options{else}set options {$params.mailmapi}{/if}endconfig nntp{if $params.newsnntp=="unset"}unset options{else}set options {$params.newsnntp}{/if}endend
</operation>
  </command>
  <command name="CONSTRAINT"/>
  <command name="CREATE">
    <operation>config antivirus profileedit "{$params.object_id}"set comment "{$params.comment}"set inspection-mode proxyset scan-botnet-connections {$params.scanbotnet}config httpset archive-log nested{if $params.webhttp=="unset"}unset options{else}set options {$params.webhttp}{/if}endconfig ftpset archive-log nested{if $params.filetransfert=="unset"}unset options{else}set options {$params.filetransfert}{/if}endconfig imapset archive-log nested{if $params.mailimap=="unset"}unset options{else}set options {$params.mailimap}{/if}endconfig pop3set archive-log nested{if $params.mailpop3=="unset"}unset options{else}set options {$params.mailpop3}{/if}endconfig smtpset archive-log nested{if $params.mailsmtp=="unset"}unset options{else}set options {$params.mailsmtp}{/if}endconfig mapiset archive-log nested{if $params.mailmapi=="unset"}unset options{else}set options {$params.mailmapi}{/if}endconfig nntpset archive-log nested{if $params.newsnntp=="unset"}unset options{else}set options {$params.newsnntp}{/if}endend
</operation>
  </command>
  <command name="DELETE">
    <operation>config antivirus profile
delete "{$Antivirus.$object_id.object_id}"
end
</operation>
  </command>
  <command name="READ"/>
  <command name="LIST"/>
</ObjectDefinition>
